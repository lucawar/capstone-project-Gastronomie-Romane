<div class="container-fluid my-5 sfondo">
  <div *ngIf="currentUser" class="profile-section">
    <h1>Benvenuto, <strong class="text-danger">{{ currentUser.name }}</strong></h1>
    <div class="user-info mt-4">
      <p><i class="bi bi-envelope-open-fill"></i> Email: <strong>{{ currentUser.email }}</strong></p>
      <p>Username: <strong>{{ currentUser.username }}</strong></p>
      <p><i class="bi bi-telephone-fill"></i> Numero telefono: <strong>{{ currentUser.numeroTelefono }}</strong></p>
    </div>

    <div class="button-group mt-4">
      <button (click)="showGastronomie = !showGastronomie" class="btn btn-danger">Gastronomie Preferite</button>
      <button (click)="showRecensioni = !showRecensioni" class="btn btn-danger">Recensioni Utente</button>
      <button (click)="showPrenotazioni = !showPrenotazioni" class="btn btn-danger">Prenotazioni Utente</button>
    </div>

    <!-- GASTRONOMIE PREFERITE -->
    <div *ngIf="showGastronomie" class="section mt-4">
      <h2>Gastronomie Preferite</h2>
      <div class="row">
        <div class="col-md-4" *ngFor="let gastronomia of currentUser.gastronomie_preferite">
          <div class="card mb-4 h-100">
            <img [src]="gastronomia.imageUrl" alt="{{ gastronomia.nome }}" class="card-img-top">
            <div class="card-body">
              <h5 class="card-title">{{ gastronomia.nome }}</h5>
              <p class="card-text"><strong>Indirizzo:</strong> {{ gastronomia.indirizzo }}</p>
              <p class="card-text"><strong>Telefono:</strong> {{ gastronomia.telefono }}</p>
              <p class="card-text"><strong>Prezzo Medio:</strong> {{ gastronomia.prezzoMedio | currency:'EUR' }}</p>
              <p class="card-text"><strong>Descrizione:</strong> {{ gastronomia.descrizione }}</p>
              <p class="card-text"><strong>Tipo Gastronomia:</strong> {{ gastronomia.tipoGastronomia }}</p>
              <button (click)="onDeleteGastronomiaPreferita(gastronomia.id)" class="btn btn-danger"> <i
                  class="bi bi-trash-fill"></i></button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- RECENSIONI UTENTE -->
    <div *ngIf="showRecensioni" class="section">
      <h2>Recensioni dell'utente:</h2>
      <ul>
        <li
          *ngFor="let recensione of currentUser.recensioni.slice(currentPage * itemsPerPage, (currentPage + 1) * itemsPerPage)">
          <div>
            <strong>Data:</strong> {{ recensione.data }}
          </div>
          <div>
            <strong>Valutazione:</strong> {{ recensione.valutazione }}
          </div>
          <div>
            <strong>Commento:</strong> {{ recensione.commento }}
          </div>
          <hr>
        </li>
      </ul>

      <!-- Bottoni di paginazione -->
      <button (click)="previousPage()" [disabled]="currentPage === 0">Precedente</button>
      <button (click)="nextPage()"
        [disabled]="(currentPage + 1) * itemsPerPage >= currentUser.recensioni.length">Successivo</button>
    </div>

    <!-- PRENOTAZIONI UTENTE -->
    <div *ngIf="showPrenotazioni" class="section">
      <h2>Prenotazioni Utente:</h2>
      <div *ngFor="let prenotazione of currentUser.prenotazioni">
        <p><strong>Nome gastronomia:</strong> {{ prenotazione.gastronomia }}</p>
        <p><strong>Data Prenotazione:</strong> {{ prenotazione.dataPrenotazione }}</p>
        <p><strong>Ora Prenotazione:</strong> {{ prenotazione.oraPrenotazione }}</p>
        <p><strong>Numero persone:</strong> {{ prenotazione.numeroPersone }}</p>
        <p><strong>Nota:</strong> {{ prenotazione.nota }}</p>
        <div class="button-group d-flex">
          <button (click)="isEditing = true" *ngIf="!isEditing" class="btn btn-primary"><i
              class="bi bi-pencil-fill"></i>Modifica</button>
          <button (click)="onDeletePrenotazione(prenotazione.id)" class="btn btn-danger mr-2"><i
              class="bi bi-trash-fill"></i></button>
        </div>
        <!-- FORM MODIFICA PRENOTAZIONE -->
        <div *ngIf="isEditing">
          <div class="card mt-4">
            <div class="card-header custom-color text-black">
              Modifica Prenotazione
            </div>
            <div class="card-body">
              <form>
                <div class="mb-3">
                  <label for="dataPrenotazione" class="form-label">Data:</label>
                  <input [(ngModel)]="updatedData.dataPrenotazione" type="date" name="dataPrenotazione"
                    class="form-control" id="dataPrenotazione">
                </div>

                <div class="mb-3">
                  <label for="oraPrenotazione" class="form-label">Ora:</label>
                  <input [(ngModel)]="updatedData.oraPrenotazione" type="time" name="oraPrenotazione"
                    class="form-control" id="oraPrenotazione">
                </div>

                <div class="mb-3">
                  <label for="numeroPersone" class="form-label">Numero di persone:</label>
                  <input [(ngModel)]="updatedData.numeroPersone" type="number" name="numeroPersone" min="1"
                    class="form-control" id="numeroPersone">
                </div>

                <div class="mb-3">
                  <label for="note" class="form-label">Note:</label>
                  <textarea [(ngModel)]="updatedData.nota" name="note" class="form-control" id="note"
                    rows="3"></textarea>
                </div>
              </form>
              <div class="button-group">
                <button (click)="onSubmitUpdate(prenotazione.id)" class="btn btn-success">Conferma</button>
                <button (click)="isEditing = false" class="btn btn-danger">Annulla</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>


  </div>
